<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>2ch風掲示板 Index</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container">

    <h1 class="title">２ちゃんねる風掲示板</h1>

    <!-- ▼ 説明欄 -->
    <div class="description">
        <p>ここは掲示板のトップページです。</p>
        <p>以下の板一覧は Supabase の boards テーブルから自動で読み込みます。</p>
    </div>

    <hr>

    <h2>板一覧</h2>

    <!-- ★ Supabase からとってくる板一覧を入れる場所 -->
    <div id="boards-list">読み込み中…</div>

</div>

<!-- ★ supabase.js（名前は正確に。supabase.js でOK） -->
<script src="supabase.js"></script>

<script>
    // HTML内の正しいIDを取得
    const boardList = document.getElementById("boards-list");

    async function loadBoards() {

        const { data, error } = await supabase
            .from("boards")
            .select("*")
            .order("id", { ascending: true });

        if (error) {
            boardList.innerHTML = "エラー: " + error.message;
            return;
        }

        if (!data || data.length === 0) {
            boardList.innerHTML = "板がありません。Supabase の boards テーブルに追加してください。";
            return;
        }

        // 正常に取得 → HTMLに表示
        boardList.innerHTML = data.map(board => `
            <div class="board-item">
                <a href="board.html?b=${board.slug}" class="board-link">
                    ${board.title}
                </a>
            </div>
        `).join("");
    }

    // ページ読み込み時に起動
    loadBoards();
</script>

</body>
</html>
